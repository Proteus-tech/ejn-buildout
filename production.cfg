[buildout]
extends = base.cfg

parts +=
    zeo
    instance2
    supervisor


[zeo]
recipe = plone.recipe.zeoserver
zeo-address = 127.0.0.1:8100
eggs += iw.rotatelogs
zeo-log-custom =
  %import iw.rotatezlogs
  <rotatelogfile>
    path ${buildout:directory}/var/log/${:_buildout_section_name_}.log
    max-bytes 20MB
    backup-count 5
    compression gzip
  </rotatelogfile>


[instance]
zeo-client = on
zeo-address = ${zeo:zeo-address}
shared-blob = on
eggs += iw.rotatezlogs
event-log-custom =
  %import iw.rotatezlogs
  <rotatelogfile>
    path ${buildout:directory}/var/log/${:_buildout_section_name_}.log
    max-bytes 20MB
    backup-count 5
    compression gzip
  </rotatelogfile>
access-log-custom =
  %import iw.rotatezlogs
  <rotatelogfile>
    path ${buildout:directory}/var/log/${:_buildout_section_name_}-Z2.log
    max-bytes 20MB
    backup-count 5
    compression gzip
  </rotatelogfile>


[instance2]
<= instance
http-address = 8081


[debug-instance]
<= instance
http-address = 8082
debug-mode = on
verbose-security = on
eggs += Products.PrintingMailHost
environment-vars = ENABLE_PRINTING_MAILHOST True


[supervisor]
recipe = collective.recipe.supervisor
plugins = superlance
http-socket = unix
file = ${buildout:directory}/var/supervisord.sock
programs =
    10 zeo ${zeo:location}/bin/runzeo ${zeo:location}
    100 instance ${buildout:directory}/bin/instance [console] ${instance:location} true
    110 instance2 ${buildout:directory}/bin/instance2 [console] ${instance2:location} true
